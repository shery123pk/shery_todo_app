# Tasks: Professional Multi-Tenant Project Management System

**Input**: Design documents from `/specs/001-project-management-system/`
**Prerequisites**: plan.md, spec.md, research.md, data-model.md, contracts/

**Organization**: Tasks are grouped by user story to enable independent implementation and testing of each story.

**Tests**: Tests are NOT explicitly requested in the specification, so test tasks are omitted. Implementation tasks only.

## Format: `[ID] [P?] [Story] Description`

- **[P]**: Can run in parallel (different files, no dependencies)
- **[Story]**: Which user story this task belongs to (US1-US10)
- Include exact file paths in descriptions

---

## Phase 1: Setup (Shared Infrastructure)

**Purpose**: Project initialization and basic structure per plan.md

- [ ] T001 Create monorepo directory structure (backend/, frontend/, shared/)
- [ ] T002 Initialize Python project in backend/ with UV and pyproject.toml dependencies (FastAPI 0.110+, SQLModel, Better Auth, python-jose, bcrypt, aiofiles, aiosmtplib, alembic, pytest, httpx, ruff, pyright)
- [ ] T003 [P] Initialize Next.js 15 project in frontend/ with TypeScript strict mode and dependencies (React 18+, Tailwind CSS v3, shadcn/ui, TanStack Query v5, Zustand, @dnd-kit/core, React Hook Form, Zod, Vitest, Playwright)
- [ ] T004 [P] Configure backend linting/formatting tools (ruff, pyright) in backend/pyproject.toml
- [ ] T005 [P] Configure frontend linting/formatting tools (ESLint, Prettier, TypeScript) in frontend/
- [ ] T006 Create .env.example files for backend and frontend with all required environment variables per quickstart.md
- [ ] T007 Create README.md files in backend/ and frontend/ with setup instructions from quickstart.md
- [ ] T008 Configure Alembic for database migrations in backend/alembic/
- [ ] T009 [P] Setup Vercel configuration in frontend/vercel.json
- [ ] T010 [P] Create Dockerfile for backend deployment

---

## Phase 2: Foundational (Blocking Prerequisites)

**Purpose**: Core infrastructure that MUST be complete before ANY user story can be implemented

**‚ö†Ô∏è CRITICAL**: No user story work can begin until this phase is complete

- [ ] T011 Create database configuration module in backend/app/database.py (async engine, session management with Neon PostgreSQL connection)
- [ ] T012 Create application configuration module in backend/app/config.py (Pydantic BaseSettings for environment variables)
- [ ] T013 Create FastAPI app initialization in backend/app/main.py (CORS, middleware, router registration, exception handlers)
- [ ] T014 [P] Create base SQLModel mixins in backend/app/models/base.py (UUID primary keys, timestamps, organization scoping)
- [ ] T015 [P] Create dependency injection utilities in backend/app/dependencies.py (get_session, get_current_user, get_current_organization)
- [ ] T016 [P] Create authentication utilities in backend/app/utils/auth.py (password hashing with bcrypt cost 12, JWT creation/verification)
- [ ] T017 [P] Create file storage service abstraction in backend/app/services/file_service.py (LocalFileStorage class with save/get_url/delete methods)
- [ ] T018 [P] Create email service in backend/app/services/email_service.py (SMTP with aiosmtplib, template methods for verification/reset/notification emails)
- [ ] T019 [P] Create error handling utilities in backend/app/utils/errors.py (custom exceptions, error response formatters)
- [ ] T020 [P] Create API client utilities in frontend/lib/api.ts (fetch wrappers with auth, error handling, base URL configuration)
- [ ] T021 [P] Create auth context provider in frontend/lib/auth.ts (session management, user state)
- [ ] T022 [P] Configure TanStack Query client in frontend/lib/queryClient.ts (default options, cache configuration)
- [ ] T023 [P] Create TypeScript type definitions in frontend/types/models.ts (User, Organization, Project, Board, Task, etc.)

**Checkpoint**: Foundation ready - user story implementation can now begin in parallel

---

## Phase 3: User Story 7 - User Authentication & Profile Management (Priority: P1) üéØ MVP

**Goal**: Enable users to create accounts, verify email, securely login, and manage their profile

**Independent Test**: New user can sign up, receive verification email, verify, login, update profile (name, avatar), and change password

### Implementation for User Story 7

- [ ] T024 [P] [US7] Create User model in backend/app/models/user.py (id, email, hashed_password, full_name, avatar_url, email_verified, timezone, language, created_at, updated_at)
- [ ] T025 [P] [US7] Create Session model in backend/app/models/user.py (id, user_id, token, refresh_token, expires_at, ip_address, user_agent, created_at)
- [ ] T026 [US7] Create Alembic migration for User and Session tables in backend/alembic/versions/001_create_users_sessions.py
- [ ] T027 [US7] Implement AuthService in backend/app/services/auth_service.py (signup, signin, signout, verify_email, forgot_password, reset_password, update_profile, change_password)
- [ ] T028 [US7] Implement POST /api/auth/signup endpoint in backend/app/routers/auth.py (create user, send verification email, return user data)
- [ ] T029 [US7] Implement POST /api/auth/signin endpoint in backend/app/routers/auth.py (verify credentials, create session, set HttpOnly cookie, return user + expiration)
- [ ] T030 [US7] Implement POST /api/auth/signout endpoint in backend/app/routers/auth.py (invalidate session, clear cookie)
- [ ] T031 [US7] Implement GET /api/auth/me endpoint in backend/app/routers/auth.py (return current user from session)
- [ ] T032 [US7] Implement POST /api/auth/verify-email endpoint in backend/app/routers/auth.py (validate token, mark email as verified)
- [ ] T033 [US7] Implement POST /api/auth/forgot-password endpoint in backend/app/routers/auth.py (generate reset token, send email, always return 200)
- [ ] T034 [US7] Implement POST /api/auth/reset-password endpoint in backend/app/routers/auth.py (validate token, update password)
- [ ] T035 [US7] Implement PUT /api/auth/profile endpoint in backend/app/routers/auth.py (update full_name, avatar_url, timezone, language)
- [ ] T036 [US7] Implement PUT /api/auth/password endpoint in backend/app/routers/auth.py (verify current password, update to new password)
- [ ] T037 [US7] Add rate limiting to auth endpoints in backend/app/routers/auth.py (5 signin per 15 min, 3 signup per hour, 3 forgot-password per hour)
- [ ] T038 [P] [US7] Create signup page in frontend/app/auth/signup/page.tsx (email, password, full_name form with validation)
- [ ] T039 [P] [US7] Create signin page in frontend/app/auth/signin/page.tsx (email, password, remember_me form)
- [ ] T040 [P] [US7] Create email verification page in frontend/app/auth/verify/page.tsx (token validation, success/error states)
- [ ] T041 [P] [US7] Create password reset flow pages in frontend/app/auth/reset/ (request page with email, reset page with token + new password)
- [ ] T042 [P] [US7] Create user profile settings page in frontend/app/me/profile/page.tsx (edit name, avatar, timezone, language)
- [ ] T043 [US7] Create Zustand auth store in frontend/stores/authStore.ts (current user state, login/logout actions)
- [ ] T044 [US7] Implement useAuth hook in frontend/lib/hooks/useAuth.ts (TanStack Query hooks for signup, signin, signout, getMe)
- [ ] T045 [US7] Create ProtectedRoute component in frontend/components/auth/ProtectedRoute.tsx (redirect to signin if not authenticated)

**Checkpoint**: User authentication fully functional and independently testable

---

## Phase 4: User Story 1 - Organization Setup & Team Onboarding (Priority: P1) üéØ MVP

**Goal**: Team lead can create organization, invite members via email, and manage roles

**Independent Test**: User creates org "Acme Corp", invites 5 members via email, assigns roles, verifies only invited members can access

### Implementation for User Story 1

- [ ] T046 [P] [US1] Create Organization model in backend/app/models/organization.py (id, slug, name, description, logo_url, owner_id, created_at, updated_at, archived)
- [ ] T047 [P] [US1] Create OrganizationMember model in backend/app/models/organization.py (id, organization_id, user_id, role enum[owner/admin/member], joined_at)
- [ ] T048 [P] [US1] Create Invitation model in backend/app/models/organization.py (id, organization_id, email, role, token UUID, invited_by, expires_at, accepted_at, created_at)
- [ ] T049 [US1] Create Alembic migration for Organization, OrganizationMember, Invitation tables in backend/alembic/versions/002_create_organizations.py
- [ ] T050 [US1] Implement POST /api/organizations endpoint in backend/app/routers/organizations.py (create org, auto-add creator as owner)
- [ ] T051 [US1] Implement GET /api/organizations endpoint in backend/app/routers/organizations.py (list user's orgs with role and counts)
- [ ] T052 [US1] Implement GET /api/organizations/{slug} endpoint in backend/app/routers/organizations.py (get org details with member/project counts)
- [ ] T053 [US1] Implement PUT /api/organizations/{slug} endpoint in backend/app/routers/organizations.py (update name, description, logo_url - admin/owner only)
- [ ] T054 [US1] Implement DELETE /api/organizations/{slug} endpoint in backend/app/routers/organizations.py (cascade delete all data - owner only, require name confirmation)
- [ ] T055 [US1] Implement GET /api/organizations/{slug}/members endpoint in backend/app/routers/organizations.py (list members with roles)
- [ ] T056 [US1] Implement POST /api/organizations/{slug}/members/invite endpoint in backend/app/routers/organizations.py (create invitation, send email, rate limit 10/hour)
- [ ] T057 [US1] Implement DELETE /api/organizations/{slug}/members/{user_id} endpoint in backend/app/routers/organizations.py (remove member - admin/owner, cannot remove owner)
- [ ] T058 [US1] Implement PUT /api/organizations/{slug}/members/{user_id}/role endpoint in backend/app/routers/organizations.py (change role - owner only)
- [ ] T059 [US1] Implement GET /api/invitations/{token} endpoint in backend/app/routers/invitations.py (view invitation details)
- [ ] T060 [US1] Implement POST /api/invitations/{token}/accept endpoint in backend/app/routers/invitations.py (accept invitation, create membership)
- [ ] T061 [US1] Implement POST /api/invitations/{token}/decline endpoint in backend/app/routers/invitations.py (mark invitation declined)
- [ ] T062 [P] [US1] Create organization list page in frontend/app/page.tsx (show user's orgs, create new org button)
- [ ] T063 [P] [US1] Create organization creation modal in frontend/components/organization/CreateOrgModal.tsx (slug, name, description form)
- [ ] T064 [P] [US1] Create organization dashboard page in frontend/app/[orgSlug]/page.tsx (recent activity, stats, project list)
- [ ] T065 [P] [US1] Create organization settings page in frontend/app/[orgSlug]/settings/page.tsx (edit name, description, logo, danger zone for delete)
- [ ] T066 [P] [US1] Create organization members page in frontend/app/[orgSlug]/members/page.tsx (list members, invite button, role management)
- [ ] T067 [P] [US1] Create member invitation modal in frontend/components/organization/InviteMemberModal.tsx (email, role selection form)
- [ ] T068 [P] [US1] Create invitation acceptance page in frontend/app/invitations/[token]/page.tsx (show org details, accept/decline buttons)
- [ ] T069 [US1] Create useOrganizations hook in frontend/lib/hooks/useOrganizations.ts (TanStack Query hooks for CRUD operations)
- [ ] T070 [US1] Create organization context provider in frontend/lib/contexts/OrganizationContext.tsx (current org state, org switcher)

**Checkpoint**: Organization management fully functional and independently testable

---

## Phase 5: User Story 2 - Project Creation & Member Assignment (Priority: P1) üéØ MVP

**Goal**: Org admin creates projects, assigns members with roles, defines project scope

**Independent Test**: Org admin creates "Website Redesign" project with key "WEB", assigns members with roles, verifies permissions control edit vs view

### Implementation for User Story 2

- [ ] T071 [P] [US2] Create Project model in backend/app/models/project.py (id, organization_id, key, name, description, icon, visibility enum[private/organization], created_by, archived, next_task_number, created_at, updated_at)
- [ ] T072 [P] [US2] Create ProjectMember model in backend/app/models/project.py (id, project_id, user_id, role enum[admin/member/viewer], added_at)
- [ ] T073 [P] [US2] Create Board model in backend/app/models/board.py (id, project_id, name, description, board_type enum[kanban], created_at, updated_at)
- [ ] T074 [P] [US2] Create Column model in backend/app/models/board.py (id, board_id, name, color hex, position float, wip_limit nullable int, created_at, updated_at)
- [ ] T075 [US2] Create Alembic migration for Project, ProjectMember, Board, Column tables in backend/alembic/versions/003_create_projects_boards.py
- [ ] T076 [US2] Implement POST /api/organizations/{orgSlug}/projects endpoint in backend/app/routers/projects.py (create project, auto-create board with 3 default columns, add creator as admin)
- [ ] T077 [US2] Implement GET /api/organizations/{orgSlug}/projects endpoint in backend/app/routers/projects.py (list org projects with member/task counts, filter by archived)
- [ ] T078 [US2] Implement GET /api/projects/{projectKey} endpoint in backend/app/routers/projects.py (get project details with members and stats)
- [ ] T079 [US2] Implement PUT /api/projects/{projectKey} endpoint in backend/app/routers/projects.py (update name, description, icon - admin only)
- [ ] T080 [US2] Implement POST /api/projects/{projectKey}/archive endpoint in backend/app/routers/projects.py (set archived=true - admin only)
- [ ] T081 [US2] Implement DELETE /api/projects/{projectKey} endpoint in backend/app/routers/projects.py (cascade delete all boards/tasks/comments/attachments - admin only)
- [ ] T082 [US2] Implement GET /api/projects/{projectKey}/members endpoint in backend/app/routers/projects.py (list project members with roles)
- [ ] T083 [US2] Implement POST /api/projects/{projectKey}/members endpoint in backend/app/routers/projects.py (add org member to project with role - admin only)
- [ ] T084 [US2] Implement DELETE /api/projects/{projectKey}/members/{user_id} endpoint in backend/app/routers/projects.py (remove member - admin only)
- [ ] T085 [US2] Implement PUT /api/projects/{projectKey}/members/{user_id}/role endpoint in backend/app/routers/projects.py (change role - admin only)
- [ ] T086 [US2] Implement GET /api/projects/{projectKey}/boards endpoint in backend/app/routers/boards.py (list project boards)
- [ ] T087 [US2] Implement GET /api/boards/{boardId} endpoint in backend/app/routers/boards.py (get board with columns and tasks, optional include_tasks query param)
- [ ] T088 [P] [US2] Create project list page in frontend/app/[orgSlug]/page.tsx (show org's projects with stats, create project button)
- [ ] T089 [P] [US2] Create project creation modal in frontend/components/project/CreateProjectModal.tsx (key, name, description, icon, visibility form)
- [ ] T090 [P] [US2] Create project dashboard page in frontend/app/[orgSlug]/[projectKey]/page.tsx (project overview, stats, recent activity)
- [ ] T091 [P] [US2] Create project settings page in frontend/app/[orgSlug]/[projectKey]/settings/page.tsx (edit project details, archive, delete)
- [ ] T092 [P] [US2] Create project members page in frontend/app/[orgSlug]/[projectKey]/members/page.tsx (list members, add member button, role management)
- [ ] T093 [US2] Create useProjects hook in frontend/lib/hooks/useProjects.ts (TanStack Query hooks for project CRUD)
- [ ] T094 [US2] Create project context provider in frontend/lib/contexts/ProjectContext.tsx (current project state)

**Checkpoint**: Project management fully functional and independently testable

---

## Phase 6: User Story 3 - Task Management on Kanban Board (Priority: P1) üéØ MVP

**Goal**: Team members create tasks, organize on Kanban board, drag-drop to update status, assign work

**Independent Test**: Member creates "Redesign homepage" task, adds details (description, priority High, assignee Alice), drags from "Todo" to "In Progress", verifies status updates

### Implementation for User Story 3

- [ ] T095 [P] [US3] Create Task model in backend/app/models/task.py (id, project_id, board_id, column_id, task_number int, title, description markdown, task_type enum[story/bug/task/epic], priority enum[critical/high/medium/low/none], assignee_id nullable, reporter_id, due_date nullable, story_points nullable, position float, labels JSON array, archived bool, completed bool, created_at, updated_at)
- [ ] T096 [US3] Create Alembic migration for Task table in backend/alembic/versions/004_create_tasks.py (with unique index on project_id, task_number and other indexes per data-model.md)
- [ ] T097 [US3] Implement TaskNumberingService in backend/app/services/task_numbering_service.py (get_next_task_number with SELECT FOR UPDATE row-level lock)
- [ ] T098 [US3] Implement POST /api/projects/{projectKey}/tasks endpoint in backend/app/routers/tasks.py (create task with auto-incremented task_number, generate display_id as KEY-NUMBER, default position)
- [ ] T099 [US3] Implement GET /api/projects/{projectKey}/tasks endpoint in backend/app/routers/tasks.py (list tasks with filters: assignee_id, priority, status/column, labels, due_before, search, archived; pagination with limit 100 default)
- [ ] T100 [US3] Implement GET /api/tasks/{taskId} endpoint in backend/app/routers/tasks.py (get task details with all fields, project info, assignee/reporter details)
- [ ] T101 [US3] Implement PUT /api/tasks/{taskId} endpoint in backend/app/routers/tasks.py (update any field, create ActivityLog entries for changes)
- [ ] T102 [US3] Implement PUT /api/tasks/{taskId}/move endpoint in backend/app/routers/tasks.py (change column_id and position, create "moved" ActivityLog entry)
- [ ] T103 [US3] Implement POST /api/tasks/{taskId}/duplicate endpoint in backend/app/routers/tasks.py (copy all fields except comments, increment task_number)
- [ ] T104 [US3] Implement POST /api/tasks/{taskId}/archive endpoint in backend/app/routers/tasks.py (set archived=true)
- [ ] T105 [US3] Implement DELETE /api/tasks/{taskId} endpoint in backend/app/routers/tasks.py (cascade delete comments/attachments/activity - admin only)
- [ ] T106 [P] [US3] Create Kanban board page in frontend/app/[orgSlug]/[projectKey]/board/page.tsx (display columns with task cards, drag-drop enabled)
- [ ] T107 [P] [US3] Create Column component in frontend/components/board/Column.tsx (column header with name/color, task list, WIP limit indicator, droppable area)
- [ ] T108 [P] [US3] Create TaskCard component in frontend/components/board/TaskCard.tsx (compact view: title, assignee avatar, priority badge, due date, draggable)
- [ ] T109 [P] [US3] Create TaskDetailModal component in frontend/components/task/TaskDetailModal.tsx (full-screen modal with all task fields, inline editing, tabs for comments/attachments/activity)
- [ ] T110 [P] [US3] Create TaskForm component in frontend/components/task/TaskForm.tsx (create/edit task form with React Hook Form + Zod validation)
- [ ] T111 [P] [US3] Create drag-and-drop logic in frontend/lib/hooks/useBoardDragDrop.ts (using @dnd-kit/core, calculate new position between tasks, optimistic updates)
- [ ] T112 [P] [US3] Create task filters component in frontend/components/board/TaskFilters.tsx (assignee, priority, labels, due date, search input)
- [ ] T113 [US3] Create useTasks hook in frontend/lib/hooks/useTasks.ts (TanStack Query hooks for task CRUD with optimistic updates)
- [ ] T114 [US3] Create useBoard hook in frontend/lib/hooks/useBoard.ts (fetch board with columns and tasks, real-time optimistic updates on drag)
- [ ] T115 [US3] Create board state store in frontend/stores/boardStore.ts (Zustand store for filters, selected task, drag state)

**Checkpoint**: Task management and Kanban board fully functional and independently testable

---

## Phase 7: User Story 4 - Task Collaboration via Comments & Activity (Priority: P2)

**Goal**: Team members discuss tasks with comments, @mention users, view activity history

**Independent Test**: Member opens task, adds comment "@Alice can you review this design?", Alice receives notification, all users see activity log with timestamps

### Implementation for User Story 4

- [ ] T116 [P] [US4] Create Comment model in backend/app/models/comment.py (id, task_id, user_id, content markdown, edited bool, created_at, updated_at)
- [ ] T117 [P] [US4] Create ActivityLog model in backend/app/models/activity.py (id, task_id, user_id, action string, field_name nullable, old_value nullable text, new_value nullable text, created_at)
- [ ] T118 [US4] Create Alembic migration for Comment and ActivityLog tables in backend/alembic/versions/005_create_comments_activity.py
- [ ] T119 [US4] Implement POST /api/tasks/{taskId}/comments endpoint in backend/app/routers/comments.py (create comment, parse @mentions, trigger notifications)
- [ ] T120 [US4] Implement GET /api/tasks/{taskId}/comments endpoint in backend/app/routers/comments.py (list comments sorted by created_at asc/desc)
- [ ] T121 [US4] Implement PUT /api/comments/{commentId} endpoint in backend/app/routers/comments.py (edit comment within 5 min of creation, set edited=true)
- [ ] T122 [US4] Implement DELETE /api/comments/{commentId} endpoint in backend/app/routers/comments.py (author or admin only)
- [ ] T123 [US4] Implement GET /api/tasks/{taskId}/activity endpoint in backend/app/routers/tasks.py (list activity logs sorted by created_at desc)
- [ ] T124 [US4] Add activity logging to task update handler in backend/app/routers/tasks.py (create ActivityLog entries for each field change)
- [ ] T125 [US4] Add activity logging to task move handler in backend/app/routers/tasks.py (create "moved" ActivityLog entry)
- [ ] T126 [P] [US4] Create CommentThread component in frontend/components/comment/CommentThread.tsx (list comments with author info, edit/delete buttons)
- [ ] T127 [P] [US4] Create CommentForm component in frontend/components/comment/CommentForm.tsx (markdown editor, @mention autocomplete, submit button)
- [ ] T128 [P] [US4] Create ActivityTimeline component in frontend/components/task/ActivityTimeline.tsx (chronological activity log with icons, user attribution)
- [ ] T129 [US4] Integrate CommentThread and ActivityTimeline into TaskDetailModal in frontend/components/task/TaskDetailModal.tsx (tabs for comments and activity)
- [ ] T130 [US4] Create useComments hook in frontend/lib/hooks/useComments.ts (TanStack Query hooks for comment CRUD)
- [ ] T131 [US4] Create useActivity hook in frontend/lib/hooks/useActivity.ts (TanStack Query hook for activity log fetching)
- [ ] T132 [US4] Implement @mention parsing and user autocomplete in frontend/lib/utils/mentions.ts (detect @username pattern, fetch matching users)

**Checkpoint**: Task collaboration features fully functional and independently testable

---

## Phase 8: User Story 5 - File Attachments for Task Documentation (Priority: P2)

**Goal**: Team members attach design mockups, documents, screenshots to tasks

**Independent Test**: Member uploads "mockup.png" (3MB) to task, sees thumbnail, other members can download, uploader can delete

### Implementation for User Story 5

- [ ] T133 [P] [US5] Create Attachment model in backend/app/models/attachment.py (id, task_id, user_id, filename, file_size int, mime_type, storage_path, created_at)
- [ ] T134 [US5] Create Alembic migration for Attachment table in backend/alembic/versions/006_create_attachments.py
- [ ] T135 [US5] Implement POST /api/tasks/{taskId}/attachments endpoint in backend/app/routers/attachments.py (multipart upload, validate MIME type/size/extension, sanitize filename, save to filesystem, max 10MB, max 20 per task)
- [ ] T136 [US5] Implement GET /api/tasks/{taskId}/attachments endpoint in backend/app/routers/attachments.py (list attachments with metadata and uploader info)
- [ ] T137 [US5] Implement GET /api/attachments/{attachmentId}/download endpoint in backend/app/routers/attachments.py (authenticated download with Content-Disposition header)
- [ ] T138 [US5] Implement DELETE /api/attachments/{attachmentId} endpoint in backend/app/routers/attachments.py (delete from storage and database - uploader or admin only)
- [ ] T139 [US5] Create upload directory structure in backend/uploads/ (organized by org_id/project_id/task_id per research.md)
- [ ] T140 [P] [US5] Create AttachmentList component in frontend/components/task/AttachmentList.tsx (thumbnail grid for images, file icons for documents, download/delete buttons)
- [ ] T141 [P] [US5] Create FileUpload component in frontend/components/task/FileUpload.tsx (drag-drop area, file input, progress indicator, size/type validation)
- [ ] T142 [P] [US5] Create image preview modal in frontend/components/task/ImagePreviewModal.tsx (full-size image view with zoom)
- [ ] T143 [US5] Integrate AttachmentList and FileUpload into TaskDetailModal in frontend/components/task/TaskDetailModal.tsx (attachments tab)
- [ ] T144 [US5] Create useAttachments hook in frontend/lib/hooks/useAttachments.ts (TanStack Query hooks for upload/list/download/delete with progress tracking)

**Checkpoint**: File attachment features fully functional and independently testable

---

## Phase 9: User Story 6 - Board & Column Customization (Priority: P2)

**Goal**: Project admins customize Kanban board columns (rename, add new states, set WIP limits)

**Independent Test**: Admin adds "Code Review" column between "In Progress" and "Done", sets WIP limit 5, team sees updated board layout

### Implementation for User Story 6

- [ ] T145 [US6] Implement POST /api/boards/{boardId}/columns endpoint in backend/app/routers/columns.py (create column with name, color, position, wip_limit - admin only)
- [ ] T146 [US6] Implement PUT /api/columns/{columnId} endpoint in backend/app/routers/columns.py (update name, color, wip_limit - admin only)
- [ ] T147 [US6] Implement DELETE /api/columns/{columnId} endpoint in backend/app/routers/columns.py (move all tasks to target column first, then delete - admin only, require move_tasks_to query param)
- [ ] T148 [US6] Add WIP limit validation to task move handler in backend/app/routers/tasks.py (warn if moving to column at/exceeding WIP limit)
- [ ] T149 [P] [US6] Create board settings page in frontend/app/[orgSlug]/[projectKey]/board/settings/page.tsx (manage columns, add/edit/delete, reorder)
- [ ] T150 [P] [US6] Create ColumnEditor component in frontend/components/board/ColumnEditor.tsx (form for name, color picker, position, WIP limit)
- [ ] T151 [P] [US6] Add WIP limit indicator to Column component in frontend/components/board/Column.tsx (show X/limit, highlight when at/over limit)
- [ ] T152 [US6] Add column drag-and-drop reordering in frontend/components/board/BoardSettings.tsx (using @dnd-kit/core, update positions)
- [ ] T153 [US6] Create useColumns hook in frontend/lib/hooks/useColumns.ts (TanStack Query hooks for column CRUD)

**Checkpoint**: Board customization features fully functional and independently testable

---

## Phase 10: User Story 8 - Dashboard & Task Overview (Priority: P3)

**Goal**: Users see dashboard with all tasks assigned to them across projects, with filtering/sorting

**Independent Test**: User navigates to "My Tasks", sees tasks from 3 projects grouped by project, filters by priority "Critical", sorts by due date

### Implementation for User Story 8

- [ ] T154 [US8] Implement GET /api/organizations/{orgSlug}/dashboard endpoint in backend/app/routers/dashboard.py (org stats: member/project counts, total tasks, completed this week, overdue, recent activity, project list)
- [ ] T155 [US8] Implement GET /api/projects/{projectKey}/dashboard endpoint in backend/app/routers/dashboard.py (project stats: tasks by status, completed this week/month, overdue, assigned to me, recent activity, upcoming deadlines)
- [ ] T156 [US8] Implement GET /api/users/me/tasks endpoint in backend/app/routers/dashboard.py (all tasks assigned to current user across all projects, with filters: status, priority, project_key, due_before, group_by, sort_by, pagination)
- [ ] T157 [P] [US8] Create organization dashboard page in frontend/app/[orgSlug]/page.tsx (display org stats, recent activity, project list with quick access)
- [ ] T158 [P] [US8] Create project dashboard page in frontend/app/[orgSlug]/[projectKey]/page.tsx (display project stats, task breakdown, recent activity, upcoming deadlines)
- [ ] T159 [P] [US8] Create "My Tasks" page in frontend/app/me/tasks/page.tsx (grouped by project, filterable, sortable, quick status update)
- [ ] T160 [P] [US8] Create DashboardStats component in frontend/components/dashboard/DashboardStats.tsx (stat cards with icons, counts, trends)
- [ ] T161 [P] [US8] Create RecentActivity component in frontend/components/dashboard/RecentActivity.tsx (activity feed with avatars, timestamps, links)
- [ ] T162 [US8] Create useDashboard hook in frontend/lib/hooks/useDashboard.ts (TanStack Query hooks for org/project/user dashboard data)

**Checkpoint**: Dashboard and overview features fully functional and independently testable

---

## Phase 11: User Story 9 - Email Notifications for Task Updates (Priority: P3)

**Goal**: Users receive email notifications when assigned tasks, @mentioned, or watching task updates

**Independent Test**: User enables email notifications in settings, gets assigned a task, receives email "You've been assigned to WEB-123", can disable notifications

### Implementation for User Story 9

- [ ] T163 [P] [US9] Create Notification model in backend/app/models/notification.py (id, user_id, type enum[task_assigned/mentioned/comment_added/due_soon], reference_id UUID, title, message, read bool, created_at)
- [ ] T164 [US9] Create Alembic migration for Notification table in backend/alembic/versions/007_create_notifications.py
- [ ] T165 [US9] Implement NotificationService in backend/app/services/notification_service.py (create_notification, send_email_notification methods)
- [ ] T166 [US9] Add notification creation to task assignment in backend/app/routers/tasks.py (trigger task_assigned notification)
- [ ] T167 [US9] Add notification creation to comment @mentions in backend/app/routers/comments.py (trigger mentioned notification)
- [ ] T168 [US9] Implement GET /api/notifications endpoint in backend/app/routers/notifications.py (list user notifications with filters: read, type, pagination)
- [ ] T169 [US9] Implement PUT /api/notifications/{notificationId}/read endpoint in backend/app/routers/notifications.py (mark as read)
- [ ] T170 [US9] Implement PUT /api/notifications/read-all endpoint in backend/app/routers/notifications.py (mark all as read)
- [ ] T171 [US9] Add email notification preferences to User model in backend/app/models/user.py (email_notifications_enabled bool field)
- [ ] T172 [US9] Implement background task for sending email notifications in backend/app/services/email_service.py (check email_verified and preferences before sending)
- [ ] T173 [P] [US9] Create notification center page in frontend/app/me/notifications/page.tsx (list notifications, mark as read, filter by type)
- [ ] T174 [P] [US9] Create NotificationBell component in frontend/components/layout/NotificationBell.tsx (bell icon in navbar, unread count badge, dropdown preview)
- [ ] T175 [P] [US9] Add notification preferences to profile settings in frontend/app/me/profile/page.tsx (toggle email notifications)
- [ ] T176 [US9] Create useNotifications hook in frontend/lib/hooks/useNotifications.ts (TanStack Query hooks for notifications, auto-refetch)

**Checkpoint**: Email notification features fully functional and independently testable

---

## Phase 12: User Story 10 - Global Search & Filters (Priority: P3)

**Goal**: Users search tasks by title/description across all projects, apply advanced filters

**Independent Test**: User types "homepage" in global search, sees results from multiple projects, filters by assignee "Alice", clicks result to open task

### Implementation for User Story 10

- [ ] T177 [US10] Implement GET /api/organizations/{orgSlug}/search endpoint in backend/app/routers/search.py (full-text search across tasks/projects, filters: q, project_key, assignee_id, priority, labels, due_before, created_after, pagination, relevance scoring)
- [ ] T178 [US10] Implement GET /api/projects/{projectKey}/search endpoint in backend/app/routers/search.py (same as org search but scoped to project)
- [ ] T179 [US10] Add full-text search indexes to Task table in backend/alembic/versions/008_add_search_indexes.py (PostgreSQL GIN index on title + description)
- [ ] T180 [P] [US10] Create global search bar in frontend/components/layout/SearchBar.tsx (autocomplete, keyboard shortcuts, recent searches)
- [ ] T181 [P] [US10] Create search results page in frontend/app/[orgSlug]/search/page.tsx (display tasks and projects, filters sidebar, sort options)
- [ ] T182 [P] [US10] Create AdvancedFilters component in frontend/components/search/AdvancedFilters.tsx (assignee, priority, labels, date ranges)
- [ ] T183 [US10] Create useSearch hook in frontend/lib/hooks/useSearch.ts (TanStack Query hooks for search with debouncing)

**Checkpoint**: Global search features fully functional and independently testable

---

## Phase 13: Polish & Cross-Cutting Concerns

**Purpose**: Improvements that affect multiple user stories

- [ ] T184 [P] Add CORS configuration to backend/app/main.py per quickstart.md (ALLOWED_ORIGINS environment variable)
- [ ] T185 [P] Add rate limiting middleware to backend/app/main.py (100 req/min per IP, 500 req/min per user, stricter for auth endpoints)
- [ ] T186 [P] Add CSRF protection to backend/app/main.py (double-submit cookie pattern)
- [ ] T187 [P] Add request logging middleware to backend/app/main.py (structured JSON logs)
- [ ] T188 [P] Add error tracking integration in backend/app/main.py (placeholder for Sentry)
- [ ] T189 [P] Create root layout in frontend/app/layout.tsx (navbar, TanStack Query provider, auth provider, Tailwind globals)
- [ ] T190 [P] Create Navbar component in frontend/components/layout/Navbar.tsx (org switcher, project nav, search, notifications, user menu)
- [ ] T191 [P] Create Sidebar component in frontend/components/layout/Sidebar.tsx (project nav, collapsible, responsive)
- [ ] T192 [P] Create UserMenu component in frontend/components/layout/UserMenu.tsx (profile, settings, signout dropdown)
- [ ] T193 [P] Create loading states and skeleton components in frontend/components/common/LoadingSkeleton.tsx
- [ ] T194 [P] Create error boundary component in frontend/components/common/ErrorBoundary.tsx (catch React errors, display fallback)
- [ ] T195 [P] Add toast notification system in frontend/components/common/Toast.tsx (success, error, info toasts)
- [ ] T196 [P] Configure shadcn/ui theme in frontend/components/ui/ (Button, Input, Modal, Select, etc.)
- [ ] T197 [P] Create dark/light mode toggle in frontend/components/layout/ThemeToggle.tsx (persist preference in localStorage)
- [ ] T198 [P] Add keyboard shortcuts handler in frontend/lib/hooks/useKeyboardShortcuts.ts (C for create task, / for search, Esc for close modal)
- [ ] T199 [P] Add form validation schemas in frontend/lib/schemas/ (Zod schemas for all forms matching backend Pydantic models)
- [ ] T200 [P] Create utility functions in frontend/lib/utils.ts (date formatting, file size formatting, color utilities, cn classname merger)
- [ ] T201 Documentation: Update backend/README.md with deployment instructions per quickstart.md
- [ ] T202 Documentation: Update frontend/README.md with build and environment variables per quickstart.md
- [ ] T203 Documentation: Create migration guide in specs/001-project-management-system/MIGRATION.md for Phase 2 ‚Üí Project Management System transition per data-model.md
- [ ] T204 Security: Add filename sanitization to file upload handler in backend/app/services/file_service.py (prevent path traversal)
- [ ] T205 Security: Add MIME type validation whitelist in backend/app/services/file_service.py per contracts/03-projects-tasks-api.md
- [ ] T206 Performance: Add database connection pooling configuration in backend/app/database.py
- [ ] T207 Performance: Add pagination defaults to all list endpoints in backend/app/routers/ (limit 100, offset 0)
- [ ] T208 Performance: Add composite indexes per data-model.md recommendations in backend/alembic/versions/009_add_performance_indexes.py
- [ ] T209 Run quickstart.md validation (verify setup instructions work end-to-end)

---

## Dependencies & Execution Order

### Phase Dependencies

- **Setup (Phase 1)**: No dependencies - can start immediately
- **Foundational (Phase 2)**: Depends on Setup completion - BLOCKS all user stories
- **User Story 7 (Phase 3)**: Depends on Foundational - Can start after Phase 2 complete
- **User Story 1 (Phase 4)**: Depends on Foundational + US7 (auth required for org creation)
- **User Story 2 (Phase 5)**: Depends on Foundational + US1 (projects belong to orgs)
- **User Story 3 (Phase 6)**: Depends on Foundational + US2 (tasks belong to projects)
- **User Story 4 (Phase 7)**: Depends on Foundational + US3 (comments belong to tasks)
- **User Story 5 (Phase 8)**: Depends on Foundational + US3 (attachments belong to tasks)
- **User Story 6 (Phase 9)**: Depends on Foundational + US2 + US3 (column customization affects tasks)
- **User Story 8 (Phase 10)**: Depends on Foundational + US1 + US2 + US3 (dashboard aggregates org/project/task data)
- **User Story 9 (Phase 11)**: Depends on Foundational + US3 + US4 (notifications for task assignment and mentions)
- **User Story 10 (Phase 12)**: Depends on Foundational + US1 + US2 + US3 (search across orgs/projects/tasks)
- **Polish (Phase 13)**: Depends on all desired user stories being complete

### User Story Dependencies

**Critical Path (P1 - MVP)**:
1. US7 (Auth) - No story dependencies, depends on Foundational
2. US1 (Orgs) - Depends on US7
3. US2 (Projects) - Depends on US1
4. US3 (Tasks) - Depends on US2

**P2 Stories (can parallelize after P1 complete)**:
- US4 (Comments) - Depends on US3
- US5 (Attachments) - Depends on US3
- US6 (Board Customization) - Depends on US2, US3

**P3 Stories (can parallelize after P1 complete)**:
- US8 (Dashboard) - Depends on US1, US2, US3
- US9 (Notifications) - Depends on US3, US4
- US10 (Search) - Depends on US1, US2, US3

### Parallel Opportunities

- **Within Setup (Phase 1)**: Tasks T003-T005, T009-T010 can run in parallel
- **Within Foundational (Phase 2)**: Tasks T014-T023 can run in parallel (different files)
- **Within User Stories**: Tasks marked [P] can run in parallel (backend models, frontend components)
- **Across User Stories**: After Foundational complete, P2 stories (US4, US5, US6) can be worked in parallel if team capacity allows
- **Backend vs Frontend**: Backend and frontend tasks for same story can run in parallel (API endpoints vs UI components)

---

## Parallel Example: User Story 3 (Task Management)

```bash
# Backend models in parallel:
T095 [P]: Task model in backend/app/models/task.py

# Backend endpoints (sequential after model):
T097-T105: Task endpoints (sequential due to shared service dependencies)

# Frontend components in parallel (after backend endpoints ready):
T106 [P]: Board page
T107 [P]: Column component
T108 [P]: TaskCard component
T109 [P]: TaskDetailModal component
T110 [P]: TaskForm component
T111 [P]: Drag-drop logic
T112 [P]: Filters component
```

---

## Implementation Strategy

### MVP First (P1 Stories Only)

1. Complete Phase 1: Setup (T001-T010)
2. Complete Phase 2: Foundational (T011-T023) - CRITICAL BLOCKER
3. Complete Phase 3: User Story 7 - Auth (T024-T045)
4. Complete Phase 4: User Story 1 - Organizations (T046-T070)
5. Complete Phase 5: User Story 2 - Projects (T071-T094)
6. Complete Phase 6: User Story 3 - Tasks (T095-T115)
7. **STOP and VALIDATE**: Test all P1 stories work independently
8. Complete Phase 13: Essential polish (T184-T200)
9. Deploy/demo MVP

**MVP Scope**: ~115 tasks covering authentication, organizations, projects, and task management

### Incremental Delivery

1. **Foundation** (Phases 1-2): ~23 tasks ‚Üí Foundation ready
2. **MVP v1** (Add P1): ~92 tasks ‚Üí Auth + Orgs + Projects + Tasks working ‚Üí Deploy
3. **MVP v2** (Add P2): ~38 tasks ‚Üí Comments + Attachments + Board customization ‚Üí Deploy
4. **MVP v3** (Add P3): ~30 tasks ‚Üí Dashboard + Notifications + Search ‚Üí Deploy
5. **Polish** (Phase 13): ~26 tasks ‚Üí Production-ready

**Total**: 209 tasks for complete implementation

### Parallel Team Strategy

With multiple developers after Foundational phase complete:

1. Team completes Setup + Foundational together (Phases 1-2)
2. Once Foundational done, split by story:
   - **Developer A**: US7 (Auth) ‚Üí then help with US1
   - **Developer B**: Wait for US7 auth, then US1 (Orgs)
   - **Developer C**: Wait for US1 orgs, then US2 (Projects)
   - **Developer D**: Wait for US2 projects, then US3 (Tasks)
3. For P2/P3 stories, parallelize:
   - **Developer A**: US4 (Comments)
   - **Developer B**: US5 (Attachments)
   - **Developer C**: US6 (Board Customization)
   - **Developer D**: US8 (Dashboard)
   - **Developer E**: US9 (Notifications)
   - **Developer F**: US10 (Search)

---

## Notes

- [P] tasks = different files, no dependencies within phase
- [Story] label maps task to specific user story for traceability
- Each user story should be independently completable and testable
- Commit after each task or logical group
- Stop at any checkpoint to validate story independently
- Backend tasks use FastAPI + SQLModel + Neon PostgreSQL per plan.md
- Frontend tasks use Next.js 15 + TypeScript + Tailwind per plan.md
- All file paths follow the monorepo structure in plan.md
- Tests are omitted (not requested in spec)
- Backward compatibility with Phase 2 todo app will be handled in migration (T203)
